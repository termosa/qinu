{"version":3,"file":"qinu.min.js","sources":["shuffle.js","qinu.js"],"sourcesContent":["const shuffle = list => {\n  let temporaryValue, randomIndex\n  let currentIndex = list.length\n\n  while (currentIndex !== 0) {\n    randomIndex = Math.floor(Math.random() * currentIndex)\n    currentIndex--\n    temporaryValue = list[currentIndex]\n    list[currentIndex] = list[randomIndex]\n    list[randomIndex] = temporaryValue\n  }\n\n  return list\n}\n\nexport default shuffle\n","import shuffle from './shuffle'\n\nconst defaults = {\n  length: 32,\n  template: '%qinu%',\n  dict: '1234567890abcdefghijklmnopqrstuvwxyz',\n  random: false\n}\n\nconst next = (key, dict) => {\n  if (!key.length) return ''\n  const i = dict.indexOf(key.slice(-1))\n  if (i + 1 < dict.length) return key.slice(0, -1) + dict[i + 1]\n  return next(key.slice(0, -1), dict) + dict[0]\n}\n\nconst generateKey = (dict, length, key = '') => {\n  if (key.length >= length) return key\n  const randomIndex = Math.floor(Math.random() * dict.length)\n  const newChar = dict[randomIndex]\n  return generateKey(dict, length, key + newChar)\n}\n\nconst applyTemplate = (template, key, args) => {\n  return args.reduce(\n    (str, arg, i) => str.replace(new RegExp(`%arg\\\\[${i}\\\\]%`, 'g'), arg),\n    template.replace(/%qinu%/g, key)\n  )\n}\n\nconst prepareDict = (dict) =>\n  shuffle(dict.split('').sort().filter((c, i, l) => l[i - 1] !== c)).join('')\n\nconst normalizeOptions = (options) => {\n  if (!options && options !== 0) return { ...defaults }\n  options = typeof options === 'object'\n    ? { ...options } : { length: +options }\n  if (options.dict) options.dict = prepareDict(options.dict)\n  return { ...defaults, ...options }\n}\n\nclass Qinu {\n  next (dict, length) {\n    const key = this.key || generateKey(dict, length)\n    this.key = next(key, dict)\n    return this.key\n  }\n}\n\n// Not an arrow function, cause it requires context\nfunction qinu (options, args) {\n  const { dict, length, template, args: optArgs, random } =\n    this instanceof Qinu ? options : normalizeOptions(options)\n  if (!(args instanceof Array)) {\n    args = Array.prototype.slice.call(arguments, 1)\n  }\n  if (optArgs instanceof Array) {\n    args = optArgs.concat(args)\n  }\n\n  const key = !random && this instanceof Qinu\n    ? this.next(dict, length) : generateKey(dict, length)\n  return applyTemplate(template, key, args)\n}\n\nqinu.create = options => qinu.bind(new Qinu(), normalizeOptions(options))\n\nexport default qinu\n"],"names":["const","defaults","length","template","dict","random","next","key","i","indexOf","slice","generateKey","newChar","Math","floor","applyTemplate","args","reduce","str","arg","replace","RegExp","prepareDict","list","let","temporaryValue","randomIndex","currentIndex","shuffle","split","sort","filter","c","l","join","normalizeOptions","options","Object","Qinu","qinu","this","optArgs","Array","prototype","call","arguments","concat","create","bind"],"mappings":"gLAAAA,ICEMC,GACJC,OAAQ,GACRC,SAAU,SACVC,KAAM,uCACNC,QAAQ,GAGJC,WAAQC,EAAKH,GACjB,IAAKG,EAAIL,OAAQ,MAAO,GACxBF,IAAMQ,EAAIJ,EAAKK,QAAQF,EAAIG,OAAO,IAClC,OAAIF,EAAI,EAAIJ,EAAKF,OAAeK,EAAIG,MAAM,GAAI,GAAKN,EAAKI,EAAI,GACrDF,EAAKC,EAAIG,MAAM,GAAI,GAAIN,GAAQA,EAAK,IAGvCO,WAAeP,EAAMF,EAAQK,GACjC,kBADuC,IACnCA,EAAIL,QAAUA,EAAQ,OAAOK,EACjCP,IACMY,EAAUR,EADIS,KAAKC,MAAMD,KAAKR,SAAWD,EAAKF,SAEpD,OAAOS,EAAYP,EAAMF,EAAQK,EAAMK,IAGnCG,WAAiBZ,EAAUI,EAAKS,GACpC,OAAOA,EAAKC,gBACTC,EAAKC,EAAKX,UAAMU,EAAIE,QAAQ,IAAIC,iBAAiBb,SAAS,KAAMW,IACjEhB,EAASiB,QAAQ,UAAWb,KAI1Be,WAAelB,mBD9BLmB,GAId,IAHAC,IAAIC,EAAgBC,EAChBC,EAAeJ,EAAKrB,OAEA,IAAjByB,GACLD,EAAcb,KAAKC,MAAMD,KAAKR,SAAWsB,GAEzCF,EAAiBF,IADjBI,GAEAJ,EAAKI,GAAgBJ,EAAKG,GAC1BH,EAAKG,GAAeD,EAGtB,OAAOF,ECmBPK,CAAQxB,EAAKyB,MAAM,IAAIC,OAAOC,gBAAQC,EAAGxB,EAAGyB,UAAMA,EAAEzB,EAAI,KAAOwB,KAAIE,KAAK,KAEpEC,WAAoBC,GACxB,OAAKA,GAAuB,IAAZA,IAChBA,EAA6B,iBAAZA,EACbC,iBAAKD,IAAclC,QAASkC,IACpBhC,OAAMgC,EAAQhC,KAAOkB,EAAYc,EAAQhC,OAC9CiC,iBAAKpC,EAAUmC,IAJgBC,iBAAKpC,IAOvCqC,eASN,SAASC,EAAMH,EAASpB,GACtB,MACEwB,gBAAgBF,EAAOF,EAAUD,EAAiBC,GAD5ChC,SAAMF,WAAQC,aAAgBsC,SAASpC,WAEzCW,aAAgB0B,QACpB1B,EAAO0B,MAAMC,UAAUjC,MAAMkC,KAAKC,UAAW,IAE3CJ,aAAmBC,QACrB1B,EAAOyB,EAAQK,OAAO9B,IAGxBhB,IAAMO,GAAOF,GAAUmC,gBAAgBF,EACnCE,KAAKlC,KAAKF,EAAMF,GAAUS,EAAYP,EAAMF,GAChD,OAAOa,EAAcZ,EAAUI,EAAKS,sBApBpCV,cAAMF,EAAMF,GACZ,IAAQK,EAAMiC,KAAKjC,KAAOI,EAAYP,EAAMF,GAE5C,OADAsC,KAAOjC,IAAMD,EAAKC,EAAKH,GACdoC,KAAKjC,KAoBhBgC,EAAKQ,gBAASX,UAAWG,EAAKS,KAAK,IAAIV,EAAQH,EAAiBC"}